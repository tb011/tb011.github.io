---
title: "Health Data Analysis"
editor: visual
categories:
  - SQL
  - NHS Data 
  - Database
---

Given series of data tables could I extract valuable information on patients an SQL database?

Let's give it a go!

**Data Tables**

![](images/data_tables.png){width="203"}

**Appendix A**

Gender: 1 = Male, 2 = Female, 9 = Unknown

Ethnicity: 01 = White, 02 = Non-white, 03 = Unknown

**Appendix B**

Primary diagnosis -- ICD-10 code:

Prostate = C61, Breast = C50, Lung = C34, Colorectal = C18, C19, C20

**How many patients were diagnosed with prostate cancer between 2015 and 2017?**


    SELECT COUNT (Patient_table.patient_id) as number_of_patients 
    FROM Patient_table 
    JOIN Tumor_table 
     ON Patient_table.patient_id = Tumor_table.patient_id 
    JOIN Regimen_table 
     ON Patient_table.patient_id = Regimen_table.patient_id 
     WHERE primary_diagnosis = 'C61' and regimen_start_date \>= '01/01/2015' and regimen_start_date \<= '31/01/2017';
